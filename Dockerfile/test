# Build enviroments
FROM zhuoqiw/sunny-build

# Copy source codes
COPY ./src /ws/src

# Use /ws as working directory
WORKDIR /ws

# colcon build
RUN /ros_entrypoint.sh \
  colcon build --cmake-args -DCMAKE_BUILD_TYPE=Release

# colcon test
RUN /ros_entrypoint.sh \
  colcon test

# Change ROS overlay
RUN sed -i 's?opt/ros/$ROS_DISTRO?ws/install?g' /ros_entrypoint.sh
